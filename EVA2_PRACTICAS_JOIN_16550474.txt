
EJERCICIOS CON JOINS

---#1: CLIENTE CON MAYOR COMPRAS---
SELECT A.COMPANYNAME, SUM(C.UNITPRICE * C.QUANTITY) AS TOTAL
FROM CUSTOMERS A
INNER JOIN ORDERS B ON A.CUSTOMERID = B.CUSTOMERID
INNER JOIN ORDERDETAILS C ON B.ORDERID = C.ORDERID
GROUP BY A.CUSTOMERID
ORDER BY TOTAL DESC LIMIT 1;

---#2: CLIENTE CON MENOR COMPRAS---
SELECT A.COMPANYNAME, SUM(C.UNITPRICE * C.QUANTITY) AS TOTAL
FROM CUSTOMERS A
INNER JOIN ORDERS B ON A.CUSTOMERID = B.CUSTOMERID
INNER JOIN ORDERDETAILS C ON B.ORDERID = C.ORDERID
GROUP BY A.CUSTOMERID
ORDER BY TOTAL LIMIT 1;

---#3: PRODUCTO MAS VENDIDO---
SELECT A.PRODUCTNAME, SUM(B.QUANTITY) AS CANTIDAD
FROM PRODUCTS A
INNER JOIN ORDERDETAILS B ON A.PRODUCTID = B.PRODUCTID
group by A.PRODUCTID
ORDER BY CANTIDAD DESC LIMIT 1;

---#4: PRODUCTO MAS LUCRATIVO---
SELECT A.PRODUCTNAME, SUM(B.UNITPRICE * B.QUANTITY) AS TOTAL
FROM PRODUCTS A
INNER JOIN ORDERDETAILS B ON A.PRODUCTID = B.PRODUCTID
group by A.PRODUCTID
ORDER BY TOTAL DESC LIMIT 1;

---#5: PRODUCTO MENOS LUCRATIVO
SELECT A.PRODUCTNAME, SUM(B.UNITPRICE * B.QUANTITY) AS TOTAL
FROM PRODUCTS A
INNER JOIN ORDERDETAILS B ON A.PRODUCTID = B.PRODUCTID
group by A.PRODUCTID
ORDER BY TOTAL LIMIT 1;

---#6: PRODUCTO MAS COMPRADO POR EL CLIENTE QUE MAS COMPRA---
SELECT A.COMPANYNAME, SUM(C.UNITPRICE * C.QUANTITY) AS TOTAL, C.QUANTITY, D.PRODUCTNAME
FROM CUSTOMERS A
INNER JOIN ORDERS B ON A.CUSTOMERID = B.CUSTOMERID
INNER JOIN ORDERDETAILS C ON B.ORDERID = C.ORDERID
INNER JOIN PRODUCTS D ON C.PRODUCTID = D.PRODUCTID
GROUP BY A.CUSTOMERID
ORDER BY TOTAL DESC LIMIT 1;

---#7: EMPLEADO CON MAS VENTAS---
SELECT A.FIRSTNAME, A.LASTNAME, SUM(C.UNITPRICE * C.QUANTITY) AS VENTAS
FROM EMPLOYEES A
INNER JOIN ORDERS B ON A.EMPLOYEEID = B.EMPLOYEEID
INNER JOIN ORDERDETAILS C ON B.ORDERID = C.ORDERID
GROUP BY B.EMPLOYEEID
ORDER BY VENTAS DESC LIMIT 1;

---#8: EMPLEADO CON MENOS VENTAS---
SELECT A.FIRSTNAME, A.LASTNAME, SUM(C.UNITPRICE * C.QUANTITY) AS VENTAS
FROM EMPLOYEES A
INNER JOIN ORDERS B ON A.EMPLOYEEID = B.EMPLOYEEID
INNER JOIN ORDERDETAILS C ON B.ORDERID = C.ORDERID
GROUP BY B.EMPLOYEEID
ORDER BY VENTAS LIMIT 1;

---#9: PROVEEDORES AL QUE HAY QUE REALIZARLES COMPRAS---
SELECT A.COMPANYNAME
FROM SUPPLIERS A 
INNER JOIN PRODUCTS B ON A.SUPPLIERID =B.SUPPLIERID
WHERE UNITSINSTOCK = 0 AND UNITSONORDER = 0;

---#10: PROVEEDOR AL QUE LE COMPRAMOS MAS---
SELECT  A.COMPANYNAME, B.UNITSONORDER, B.UNITPRICE, SUM(B.UNITSONORDER * B.UNITPRICE) AS COMPRA
FROM SUPPLIERS A 
INNER JOIN PRODUCTS B ON A.SUPPLIERID = B.SUPPLIERID
GROUP BY B.PRODUCTID
ORDER BY COMPRA DESC LIMIT 1;
